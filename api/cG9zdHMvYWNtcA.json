{"title":"Android使用 Termux 搭建web服务并实现外网访问","date":"2020-04-03T14:11:00.000Z","date_formatted":{"ll":"2020年4月3日","L":"2020/04/03","MM-DD":"04-03"},"thumbnail":"https://cdn.jsdelivr.net/gh/idkzr/static@master/imgs/acmp/cover.jpg","color":"#111","link":"posts/acmp","comments":true,"tags":["Termux","web"],"categories":["瞎折腾"],"updated":"2020-04-03T14:11:00.000Z","content":"<p>相信各位家里面应该都有闲置的Android设备，反正也是闲置，不如利用起来搭建一个小网站。</p>\n<a id=\"more\"></a>\n<p><strong>文章已失效，仅供参考</strong></p>\n<h2 id=\"前言\">前言<a title=\"#前言\" href=\"#前言\"></a></h2>\n<p>termux是什么：</p>\n<blockquote>\n<p>Termux是一个Android下一个高级的终端模拟器, 开源且不需要root, 支持apt管理软件包，十分方便安装软件包, 完美支持Python, PHP, Ruby, Go, Nodejs, MySQL等。</p>\n</blockquote>\n<h2 id=\"一、优化termux使用\">一、优化termux使用<a title=\"#一、优化termux使用\" href=\"#一、优化termux使用\"></a></h2>\n<p>因为一些原因，termux自带的软件源在国内的速度并不理想，所以我们先使用以下命令修改为清华大学提供的软件源。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sed -i &#x27;s@^\\(deb.*stable main\\)$@#\\1\\ndeb https://mirrors.tuna.tsinghua.edu.cn/termux/termux-packages-24 stable main@&#x27; $PREFIX/etc/apt/sources.list</span><br><span class=\"line\">sed -i &#x27;s@^\\(deb.*games stable\\)$@#\\1\\ndeb https://mirrors.tuna.tsinghua.edu.cn/termux/game-packages-24 games stable@&#x27; $PREFIX/etc/apt/sources.list.d/game.list</span><br><span class=\"line\">sed -i &#x27;s@^\\(deb.*science stable\\)$@#\\1\\ndeb https://mirrors.tuna.tsinghua.edu.cn/termux/science-packages-24 science stable@&#x27; $PREFIX/etc/apt/sources.list.d/science.list</span><br><span class=\"line\">pkg up</span><br></pre></td></tr></table></figure>\n<p>输入： <code>termux-setup-storage</code> 获取并授予存储权限</p>\n<p>输入以下内容修复快捷键：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &quot;extra-keys = [[&#x27;ESC&#x27;,&#x27;TAB&#x27;,&#x27;CTRL&#x27;,&#x27;ALT&#x27;,&#x27;-&#x27;,&#x27;/&#x27;,&#x27;~&#x27;,&#x27;:&#x27;,&#x27;;&#x27;],[&#x27;[&#x27;,&#x27;!&#x27;,&#x27;PGUP&#x27;,&#x27;HOME&#x27;,&#x27;UP&#x27;,&#x27;END&#x27;,&#x27;PGDN&#x27;,&#x27;\\&quot;&#x27;,&#x27;]&#x27;],[&#x27;&#123;&#x27;,&#x27;&lt;&#x27;,&#x27;(&#x27;,&#x27;LEFT&#x27;,&#x27;DOWN&#x27;,&#x27;RIGHT&#x27;,&#x27;)&#x27;,&#x27;&gt;&#x27;,&#x27;&#125;&#x27;]]&quot; &gt;&gt; ~/.termux/termux.properties</span><br></pre></td></tr></table></figure>\n<p>可选操作：</p>\n<p>安装zsh：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sh -c &quot;$(curl -fsSL https://gitee.com/idkzr/termux-ohmyzsh/raw/master/install.sh)&quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"二、安装caddy-mariadb-php\">二、安装Caddy MariaDB PHP<a title=\"#二、安装caddy-mariadb-php\" href=\"#二、安装caddy-mariadb-php\"></a></h2>\n<p>Caddy是一个易于使用的通用web服务器。</p>\n<p>MariaDB数据库管理系统是MySQL的一个分支，主要由开源社区在维护，采用GPL授权许可 MariaDB的目的是完全兼容MySQL，包括API和命令行，使之能轻松成为MySQL的代替品。</p>\n<p>使用 <code>bash &lt;(curl https://idkzr.com/shell/acmp.sh)</code>即可一键安装</p>\n<p>什么？不想使用一键命令？</p>\n<p>在Termux中依次执行</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pkg i wget vim mariadb php php-fpm -y</span><br><span class=\"line\"></span><br><span class=\"line\">curl https://getcaddy.com | bash -s personal</span><br></pre></td></tr></table></figure>\n<h2 id=\"三、配置mysql数据库\">三、配置MySql数据库<a title=\"#三、配置mysql数据库\" href=\"#三、配置mysql数据库\"></a></h2>\n<p>输入 <code>mysqld</code> 启动数据库，启动完成后,这个会话就一直存活,类似与debug调试一样,只有新建会话才可以操作。</p>\n<p>新建一个termux会话</p>\n<p>输入<code>mysql</code>直接进入mariadb数据库，输入：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set password for &quot;root&quot;@&quot;localhost&quot; &#x3D; password(&quot;123456789&quot;)</span><br></pre></td></tr></table></figure>\n<p>将123456789修改为你要使用的密码</p>\n<p>输入一下<code>mysql_secure_installation</code>进入快速设置向导，输入当前密码既可。</p>\n<p>下面根据个人偏好来进行设置,没有绝对的要求</p>\n<p>Set root password? [Y/n] n#是否设置新的root密码</p>\n<p>Remove anonymous users? [Y/n] Y#是否移除匿名用户</p>\n<p>Disallow root login remotely? [Y/n] n#是否不允许root远程登录</p>\n<p>Removetestdatabase and access to it? [Y/n] n#是否移除test数据库</p>\n<p>Reload privilege tables now? [Y/n] y#是否重新加载表的权限</p>\n<h2 id=\"四、配置php-fpm\">四、配置PHP-fpm<a title=\"#四、配置php-fpm\" href=\"#四、配置php-fpm\"></a></h2>\n<p>输入<code>vim ../usr/etc/php-fpm.d/www.conf</code><br>\n找到：<code>listen = /data/data/com.termux/files/usr/var/run/php-fpm.sock</code><br>\n修改为：<code>127.0.0.1:9000</code><br>\n保存并退出<br>\n输入 <code>php-fpm</code> 启动PHP</p>\n<h2 id=\"五、配置typecho\">五、配置Typecho<a title=\"#五、配置typecho\" href=\"#五、配置typecho\"></a></h2>\n<p>在内置存储新建一个 <code>www</code> 文件夹<br>\n使用<code>ln -s /data/data/com.termux/files/home/storage/shared/www www</code>将文件夹软连接到termux工作目录<br>\n将typecho程序解压到内置存储 www 文件夹中</p>\n<p>输入 <code>caddy</code>启动web服务</p>\n<h2 id=\"六、配置frp\">六、配置frp<a title=\"#六、配置frp\" href=\"#六、配置frp\"></a></h2>\n<p>新建一个termux会话<br>\n输入下方命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">下载frpc二进制文件</span></span><br><span class=\"line\"></span><br><span class=\"line\">mkdir frp &amp;&amp; cd frp &amp;&amp; wget https://qianqu.me/frp/frpc_linux_arm64 -O frpc &amp;&amp; chmod +x frpc</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">创建配置文件</span></span><br><span class=\"line\"></span><br><span class=\"line\">touch frpc.ini &amp;&amp; chmod +x frpc.ini</span><br><span class=\"line\"></span><br><span class=\"line\">vim frpc.ini</span><br></pre></td></tr></table></figure>\n<p>将配置文件粘贴到frpc.ini中<br>\n输入./frpc启动frp</p>\n<h2 id=\"end\">END<a title=\"#end\" href=\"#end\"></a></h2>\n","prev":{"title":"愿逝者安息，愿生者奋发，愿祖国昌盛！","link":"posts/rip"},"next":{"title":"可能是Windows上最强的开源任务管理器：Process Hacker","link":"posts/process-hacker"},"plink":"https://blog.zr.ci/posts/acmp/","toc":[{"id":"前言","title":"前言","index":"1"},{"id":"一、优化termux使用","title":"一、优化termux使用","index":"2"},{"id":"二、安装caddy-mariadb-php","title":"二、安装Caddy MariaDB PHP","index":"3"},{"id":"三、配置mysql数据库","title":"三、配置MySql数据库","index":"4"},{"id":"四、配置php-fpm","title":"四、配置PHP-fpm","index":"5"},{"id":"五、配置typecho","title":"五、配置Typecho","index":"6"},{"id":"六、配置frp","title":"六、配置frp","index":"7"},{"id":"end","title":"END","index":"8"}],"copyright":{"author":"箴扰","link":"<a href=\"https://blog.zr.ci/posts/acmp/\" title=\"Android使用 Termux 搭建web服务并实现外网访问\">https://blog.zr.ci/posts/acmp/</a>","license":"本博客所有文章除特别声明外，均采用(<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"nofollow\" target=\"_blank\">CC BY-NC-SA 4.0</a>)许可协议，转载请注明来源<a href=\"https://blog.zr.ci\" rel=\"nofollow\" target=\"_blank\">箴扰</a>！"}}